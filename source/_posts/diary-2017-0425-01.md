---
layout: post
title: 向安卓app中注入payload后门
date: 2017-04-25 17:08:41
comments: true
tags:
	- 安全攻防
	- 安卓
---



### 前言
><font color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**文中提及的部分技术，可能带有一定攻击性，仅供安全学习和教学用途，禁止非法使用！**</font>
>


### 正文

在前面的文章中我有说到过如何向android植入后门app，我们用的方法是使用msf生成一个payload，需要用户单独安装后才行。[(点我)](https://y00z.github.io/2016/12/19/diary-2016-1219-01/)<!--more-->
那么可不可以向一个正常的app注入payload呢，当然是可以的。原理就是反编译app,然后在app中注入payload代码，然后再重新编译打包。前提是app没有做过一些加固等操作.


在msf中就提供了这样注入方式。

![](/images/pasted-98.jpg)

会对该app进行反编译，然后会找到可以注入载荷的钩子点。进一步，它会利用可用于后渗透活动的附加权限使该app的Android清单文件染毒。

![](/images/pasted-99.jpg)

这里呢，我使用[backdoor-apk](https://github.com/dana-at-cp/backdoor-apk)来向app注入payload

![](/images/pasted-101.jpg)

其中有3个选项，
 * 选择反弹的payload
 * 监听的ip
 * 监听的端口

完毕之后染毒的apk在original/dist目录中，并且会在本地生成一个backdoor-apk.rc文件。

backdoor-apk.rc里面包含着msf的所有配置，所以我们可以直接启动msf并且指定backdoor-apk.rc文件即可。会自动帮我们把msf配置好

![](/images/pasted-102.jpg)

手机安装上染毒的apk，msf成功收到反弹到一个会话

![](/images/pasted-103.jpg)