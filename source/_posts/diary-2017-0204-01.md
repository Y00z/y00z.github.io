---
layout: post
title: drozer对app安全测试
date: 2017-02-04 11:44:08
comments: true
tags:
	- 安卓
	- 安全攻防
---

#### 前言
>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;最近发现一款不错的Android安全测试框架
>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;其官方文档说道：“Drozer允许你一一个普通android应用的身份与其他应用和操作系统交互。”
>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在Web世界已经有了许多安全测试工具了，我们只需要给出一个目标，这些工具就会自动为我们安全测试报告。但Drozer与这样的自动化扫描器不同，Drozer是一种交互式的安全测试工具。使用Drozer进行安全测试，用户在自己的工作站上输入命令，Drozer会将命令发送到Android设备上的代理程序执行。

#### 配置环境 <!--more-->
> 电脑和手机都需要安装drozer
> 下载地址
> https://www.mwrinfosecurity.com/products/drozer/community-edition/
> 我电脑是windows的，安装完毕后，dos切换到drozer安装目录。
> ![](/images/pasted-33.png)

###### 连接手机
> 然后手机上安装好drozer并且开启server默认端口31415
> 
> ![](/images/pasted-34.jpg)
>然后手机打开调试usb连接电脑，
>输入指令做端口转发 `adb forward tcp:31415 tcp:31415`
>必须在`adb devices` 有显示手机设备才可以。
>dos中，在drozer安装目录输入指令  
> `drozer console connect`
> ![](/images/pasted-34.png)
> 连接成功了。


#### 功能介绍

###### 所有的模块
> * list 
> 查看框架所有的模块
> ![](/images/pasted-35.png)
> * run app.package.list
> 列出手机上所有应用包名

###### 查看包名
> * run app.package.list
> ![](/images/pasted-36.png)
> ps: 为了一些有心人士,所以打了码,不好意思。
> 加上-f参数，搜索特定包名支持模糊搜索：
> * run app.package.list -f (string to be searched)
> ![](/images/pasted-37.png)

###### 查看包详情
>* run app.package.info –a (package name)
> ![](/images/pasted-38.png)

###### 扫描攻击面
>扫描指定app的攻击面。
> * run app.package.attacksurface (package name)
> ![](/images/pasted-39.png)
> 可以看到有3个暴露的activity，现在我们需要找出暴露activity的名字并检查是否有敏感信息

###### 查看暴露的页面
> * run app.activity.info –a (package name)
> ![](/images/pasted-40.png)
> 如果暴露的页面是需要登录之后获取一些操作之后才能看到的页面。那么用drozer绕过登录认证，直接打开这个页面。


###### 打开暴露的页面
> * run app.activity.start --component (package name) (activity name)
> ![](/images/pasted-41.png)
>会直接启动该activity。
> ![](/images/pasted-42.png)
> 就这样我们成功绕过了登录认证。
> 由于我在页面写了检测到如果没有登录，就重新跳到登录页面，所以有弹出框。

#### 漏洞原因
>在AndroidManifest.xml中activity有一个属性android:exported，当这个属性为true的时候，表示该组件可以被其他组件调用。所以直接不写这个属性就可以了，默认false。
>ps:其实这个app本来是没这个属性，我为了方便演示才加上的。