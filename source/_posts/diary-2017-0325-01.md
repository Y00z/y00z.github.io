---
layout: post
title: xposed环境搭建
date: 2017-03-25 18:55:37
comments: true
tags:
	- xposed
---
### 前言
>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Xposed是GitHUB上rovo89大神设计开发的一个针对Android平台的动态劫持项目，通过替换/system/bin/app_process程序控制zygote进程，使得app_process在启动过程中会加载XposedBridge.jar这个jar包，从而完成对Zygote进程及其创建的Dalvik虚拟机的劫持。Xposed在开机的时候完成对所有的Hook Function的劫持，在原Function执行的前后加上自定义代码。

### 正文<!--more-->
> 安卓环境就不多说了。
> ##### 1 创建一个安卓工程项目
> 初识状态

> ![](/images/pasted-48.jpg)

> ##### 2 导入xposed的jar包
> 下载地址：
> * https://bintray.com/rovo89/de.robv.android.xposed/api
> 下载里面的`api-82-sources.jar`和`api-82.jar`
> 导入到项目的lib目录下

> ##### 3 修改AndroidManifest.xml
> 在application节点中加入代码
>
```xml
       <meta-data
            android:name="xposedmodule"
            android:value="true" />
        <meta-data
            android:name="xposeddescription"
            android:value="Hook log test" />
        <meta-data
            android:name="xposedminversion"
            android:value="53" />
```

> ##### 4 修改build.gradle
>`provided` 方式导入jar包
```gradle
dependencies {
    compile 'com.android.support:appcompat-v7:25.2.0'
    testCompile 'junit:junit:4.12'
    provided 'de.robv.android.xposed:api:82'
    provided 'de.robv.android.xposed:api:82:sources'
}
```
><font color="#ff0000" fontSize="28sp">注意,注意,注意,注意,注意,注意</font>
这里默认有个 `compile fileTree(dir: 'libs', include: ['*.jar'])`  一定要删掉。

> ##### 5 创建一个类
> 创建一个`Tutorial`类，继承`IXposedHookLoadPackage`
> 
```java
public class Tutorial implements IXposedHookLoadPackage {
    public void handleLoadPackage(final LoadPackageParam lpparam) throws Throwable {
        XposedBridge.log("正在加载中....." + lpparam.packageName);
    }
}
```

> ##### 6 创建入口文件。
> 创建一个`assets`文件，并且在里面创建一个`xposed_init`文件。
> `xposed_init`里面内容为`Tutorial`的完全路径
> `hk.myapplication03.Tutorial`  //完整类名:包名+类名

>Ok，全部已经搭建好了，来运行一下，需要进到框架中激活并且重启才能生效。
>查看一下log日志。

> ![](/images/pasted-49.jpg)


>OK了， 环境搭建完成并且成功的实现了一个简单的HOOK